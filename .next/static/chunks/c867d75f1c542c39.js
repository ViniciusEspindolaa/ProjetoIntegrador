(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99299,e=>{"use strict";var a=e.i(1972),t=e.i(75305),s=e.i(30374),l=e.i(67881),n=e.i(23750),r=e.i(10708),o=e.i(84762),i=e.i(49110),c=e.i(74679),d=e.i(86591);function m({pet:e,open:m,onClose:u,onSubmit:h}){let[p,x]=(0,t.useState)(""),[g,j]=(0,t.useState)(""),[v,f]=(0,t.useState)(""),[b,N]=(0,t.useState)(""),[w,S]=(0,t.useState)(""),[y,C]=(0,t.useState)("");return e?(0,a.jsx)(s.Dialog,{open:m,onOpenChange:u,children:(0,a.jsxs)(s.DialogContent,{className:"max-w-md max-h-[90vh] overflow-y-auto z-[99999]",children:[(0,a.jsxs)(s.DialogHeader,{children:[(0,a.jsx)(s.DialogTitle,{children:"Reportar Avistamento"}),(0,a.jsxs)(s.DialogDescription,{children:["Ajude a encontrar ",e.name||"este pet"," reportando onde você o viu"]})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h({location:{lat:-23.5505,lng:-46.6333,address:p,city:"São Paulo"},date:new Date(g),time:v,description:b,reporterName:w,reporterPhone:y}),x(""),j(""),f(""),N(""),S(""),C(""),u()},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(r.Label,{htmlFor:"location",children:[(0,a.jsx)(i.MapPin,{className:"w-4 h-4 inline mr-1"}),"Local do avistamento"]}),(0,a.jsx)(n.Input,{id:"location",placeholder:"Rua, bairro ou ponto de referência",value:p,onChange:e=>x(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(r.Label,{htmlFor:"date",children:[(0,a.jsx)(c.Calendar,{className:"w-4 h-4 inline mr-1"}),"Data"]}),(0,a.jsx)(n.Input,{id:"date",type:"date",value:g,onChange:e=>j(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(r.Label,{htmlFor:"time",children:[(0,a.jsx)(d.Clock,{className:"w-4 h-4 inline mr-1"}),"Hora"]}),(0,a.jsx)(n.Input,{id:"time",type:"time",value:v,onChange:e=>f(e.target.value),required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{htmlFor:"description",children:"Descrição"}),(0,a.jsx)(o.Textarea,{id:"description",placeholder:"O que você viu? Como o pet estava?",value:b,onChange:e=>N(e.target.value),required:!0,rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{htmlFor:"reporterName",children:"Seu nome"}),(0,a.jsx)(n.Input,{id:"reporterName",placeholder:"Nome completo",value:w,onChange:e=>S(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{htmlFor:"reporterPhone",children:"Seu telefone"}),(0,a.jsx)(n.Input,{id:"reporterPhone",type:"tel",placeholder:"+55 11 98765-4321",value:y,onChange:e=>C(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.Button,{type:"button",variant:"outline",onClick:u,className:"flex-1",children:"Cancelar"}),(0,a.jsx)(l.Button,{type:"submit",className:"flex-1",children:"Enviar Avistamento"})]})]})]})}):null}e.s(["SightingDialog",()=>m])},31713,e=>{"use strict";var a=e.i(1972),t=e.i(75305),s=e.i(30499),l=e.i(91432),n=e.i(54858);function r(e){let a=e.fotos_urls,t="/placeholder-pet.png";if(Array.isArray(a)&&a.length>0)t=a[0];else if("string"==typeof a&&a.length>0)t=a;else if(a&&"object"==typeof a&&Object.keys(a).length>0){let e=Object.values(a);e.length>0&&(t=String(e[0]))}let s=(e.avistamentos||[]).map(a=>({id:String(a.id),petId:String(e.id),location:{lat:Number(a.latitude),lng:Number(a.longitude),address:a.endereco_texto||"",city:"",neighborhood:""},date:a.data_avistamento?new Date(a.data_avistamento):new Date,time:a.data_avistamento?new Date(a.data_avistamento).toLocaleTimeString():"",description:a.observacoes||"",reporterName:a.usuario?.nome||"",reporterPhone:a.usuario?.telefone||"",createdAt:a.data_avistamento?new Date(a.data_avistamento):new Date}));return{id:String(e.id),userId:e.usuarioId||e.usuario&&e.usuario.id||"",status:function(e){switch(e){case"PERDIDO":default:return"lost";case"ENCONTRADO":return"found";case"ADOCAO":return"adoption"}}(e.tipo),name:e.nome_pet||e.titulo||void 0,type:function(e){switch(e){case"CACHORRO":return"dog";case"GATO":return"cat";default:return"other"}}(e.especie),breed:e.raca||"",size:function(e){switch(e){case"PEQUENO":return"small";case"MEDIO":default:return"medium";case"GRANDE":return"large"}}(e.porte),age:e.idade?String(e.idade):void 0,location:{lat:Number(e.latitude),lng:Number(e.longitude),address:e.endereco_texto||"",city:"",neighborhood:""},lastSeenDate:e.data_evento?new Date(e.data_evento):e.data_publicacao?new Date(e.data_publicacao):new Date,description:e.descricao||"",photoUrl:t,reward:void 0,contactPhone:e.usuario?.telefone||"",contactName:e.usuario?.nome||"",sightings:s,createdAt:e.data_publicacao?new Date(e.data_publicacao):new Date}}var o=e.i(6950),i=e.i(99299),c=e.i(67058),d=e.i(30374),m=e.i(67881),u=e.i(10965);let h=(0,u.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var p=e.i(99660),x=e.i(28849);function g({pet:s,open:l,onClose:n}){let r=(0,t.useRef)(null);if(!s)return null;let o={lost:{label:"PERDIDO",color:"bg-red-600",datePrefix:"Perdido em"},found:{label:"ENCONTRADO",color:"bg-blue-600",datePrefix:"Encontrado em"},adoption:{label:"PARA ADOÇÃO",color:"bg-green-600",datePrefix:"Disponível desde"}}[s.status],i=async()=>{if(r.current)try{let a=(await e.A(66997)).default,t=await a(r.current,{scale:2,backgroundColor:"#ffffff"}),l=document.createElement("a");l.download=`poster-${s.name||"pet"}-${s.id}.png`,l.href=t.toDataURL("image/png"),l.click()}catch(e){alert("Erro ao gerar poster. Por favor, tente novamente.")}},c=async a=>{if(r.current)try{let t=(await e.A(66997)).default,l=await t(r.current,{scale:2,backgroundColor:"#ffffff"});l.toBlob(async e=>{if(!e)return;new File([e],`poster-${s.name||"pet"}.png`,{type:"image/png"});let t=`${o.label}: ${s.name||"Pet sem nome"}
${s.breed}
${s.location.city}
Contato: ${s.contactPhone}`;if("whatsapp"===a){let e=encodeURIComponent(t);window.open(`https://wa.me/?text=${e}`,"_blank")}else if("facebook"===a)window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`,"_blank");else if("instagram"===a){let e=document.createElement("a");e.download=`poster-${s.name||"pet"}-instagram.png`,e.href=l.toDataURL("image/png"),e.click(),alert("Imagem baixada! Agora você pode compartilhar no Instagram.")}})}catch(e){alert("Erro ao compartilhar. Por favor, tente novamente.")}};return(0,a.jsx)(d.Dialog,{open:l,onOpenChange:n,children:(0,a.jsxs)(d.DialogContent,{className:"max-w-sm md:max-w-md max-h-[90vh] overflow-auto",children:[(0,a.jsxs)(d.DialogHeader,{children:[(0,a.jsx)(d.DialogTitle,{children:"Compartilhar Anúncio"}),(0,a.jsx)(d.DialogDescription,{children:"Baixe o poster ou compartilhe nas redes sociais"})]}),(0,a.jsxs)("div",{ref:r,className:"bg-white rounded-lg overflow-hidden border-2 border-gray-800",children:[(0,a.jsx)("div",{className:`${o.color} text-white text-center py-3`,children:(0,a.jsx)("h2",{className:"text-2xl font-black",children:o.label})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"relative aspect-square rounded-lg overflow-hidden mb-3",children:(0,a.jsx)(x.default,{src:s.photoUrl||"/placeholder.svg",alt:s.name||"Pet",fill:!0,className:"object-cover"})}),s.name&&(0,a.jsx)("h3",{className:"text-2xl font-bold text-center mb-4",children:s.name}),(0,a.jsxs)("div",{className:"space-y-2.5 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Raça:"}),(0,a.jsx)("span",{children:s.breed})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t pt-2.5",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Local:"}),(0,a.jsx)("span",{children:s.location.city})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between border-t pt-2.5",children:[(0,a.jsxs)("span",{className:"font-semibold",children:[o.datePrefix,":"]}),(0,a.jsx)("span",{children:new Date(s.lastSeenDate).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),s.reward&&(0,a.jsx)("div",{className:"border-t pt-2.5",children:(0,a.jsxs)("p",{className:"text-center text-lg font-bold text-amber-600",children:["RECOMPENSA: R$ ",s.reward]})}),(0,a.jsxs)("div",{className:"border-t pt-2.5 text-center",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"CONTATO"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:s.contactPhone}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:s.contactName})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(m.Button,{onClick:i,className:"w-full",children:[(0,a.jsx)(h,{className:"w-4 h-4 mr-2"}),"Baixar Poster (PNG)"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-center",children:"Compartilhar em:"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsxs)(m.Button,{onClick:()=>c("whatsapp"),className:"bg-green-600 hover:bg-green-700 h-10 text-xs",children:[(0,a.jsx)(p.Share2,{className:"w-3 h-3 mr-1"}),"WhatsApp"]}),(0,a.jsxs)(m.Button,{onClick:()=>c("facebook"),className:"bg-blue-600 hover:bg-blue-700 h-10 text-xs",children:[(0,a.jsx)(p.Share2,{className:"w-3 h-3 mr-1"}),"Facebook"]}),(0,a.jsxs)(m.Button,{onClick:()=>c("instagram"),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 h-10 text-xs",children:[(0,a.jsx)(p.Share2,{className:"w-3 h-3 mr-1"}),"Instagram"]})]})]})]})]})})}var j=e.i(10708),v=e.i(84762),f=e.i(62870);let b=(0,u.default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function N({pet:e,open:s,onClose:l}){let[n,r]=(0,t.useState)(""),[o,i]=(0,t.useState)(""),[c,u]=(0,t.useState)(!1),h=async e=>{e.preventDefault(),u(!0),await new Promise(e=>setTimeout(e,1500)),alert("Denúncia enviada com sucesso. Nossa equipe irá analisar."),r(""),i(""),u(!1),l()};return e?(0,a.jsx)(d.Dialog,{open:s,onOpenChange:l,children:(0,a.jsxs)(d.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(d.DialogHeader,{children:[(0,a.jsxs)(d.DialogTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(b,{className:"w-5 h-5 text-amber-600"}),"Denunciar Publicação"]}),(0,a.jsx)(d.DialogDescription,{children:"Informe o motivo da denúncia. Nossa equipe analisará o caso."})]}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.Label,{htmlFor:"reason",className:"text-sm",children:"Motivo da denúncia *"}),(0,a.jsxs)(f.Select,{value:n,onValueChange:r,required:!0,children:[(0,a.jsx)(f.SelectTrigger,{id:"reason",className:"text-sm",children:(0,a.jsx)(f.SelectValue,{placeholder:"Selecione o motivo"})}),(0,a.jsxs)(f.SelectContent,{children:[(0,a.jsx)(f.SelectItem,{value:"fake",children:"Anúncio falso ou enganoso"}),(0,a.jsx)(f.SelectItem,{value:"inappropriate",children:"Conteúdo inapropriado"}),(0,a.jsx)(f.SelectItem,{value:"spam",children:"Spam ou propaganda"}),(0,a.jsx)(f.SelectItem,{value:"abuse",children:"Maus tratos ao animal"}),(0,a.jsx)(f.SelectItem,{value:"duplicate",children:"Publicação duplicada"}),(0,a.jsx)(f.SelectItem,{value:"scam",children:"Tentativa de golpe"}),(0,a.jsx)(f.SelectItem,{value:"other",children:"Outro motivo"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.Label,{htmlFor:"details",className:"text-sm",children:"Detalhes adicionais (opcional)"}),(0,a.jsx)(v.Textarea,{id:"details",value:o,onChange:e=>i(e.target.value),placeholder:"Forneça mais informações sobre a denúncia...",rows:4,className:"text-sm resize-none"})]}),(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-xs text-amber-800",children:"Denúncias falsas ou mal-intencionadas podem resultar em suspensão da conta. Por favor, denuncie apenas conteúdo que viole nossas diretrizes."})}),(0,a.jsxs)(d.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,a.jsx)(m.Button,{type:"button",variant:"outline",onClick:l,className:"text-sm",children:"Cancelar"}),(0,a.jsx)(m.Button,{type:"submit",disabled:!n||c,variant:"destructive",className:"text-sm",children:c?"Enviando...":"Enviar Denúncia"})]})]})]})}):null}var w=e.i(89752),S=e.i(23750);let y=(0,u.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function C(){let{user:e,isLoading:d}=(0,l.useAuth)(),m=(0,s.useRouter)(),[u,h]=(0,t.useState)([]),[p,x]=(0,t.useState)([]),[j,v]=(0,t.useState)(!1),[b,C]=(0,t.useState)(""),[D,I]=(0,t.useState)("all"),[A,P]=(0,t.useState)("all"),[k,O]=(0,t.useState)(null),[R,T]=(0,t.useState)(null),[E,L]=(0,t.useState)(null),[_,q]=(0,t.useState)(null);(0,t.useEffect)(()=>{d||e||m.push("/login")},[e,d,m]),(0,t.useEffect)(()=>{let e=!0;return async function(){v(!0);try{let a=(await (0,n.apiFetch)("/api/publicacoes")).map(r);e&&(h(a),x(a))}catch(e){console.error("Failed to load publicacoes",e)}finally{v(!1)}}(),()=>{e=!1}},[]),(0,t.useEffect)(()=>{let e=u;b&&(e=e.filter(e=>e.name?.toLowerCase().includes(b.toLowerCase())||e.breed.toLowerCase().includes(b.toLowerCase())||e.location.address.toLowerCase().includes(b.toLowerCase())||e.location.city.toLowerCase().includes(b.toLowerCase()))),"all"!==D&&(e=e.filter(e=>e.status===D)),"all"!==A&&(e=e.filter(e=>e.type===A)),x(e)},[b,D,A,u]);let B=e=>{m.push(`/map?petId=${e.id}`)};return d?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Carregando..."})]})}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-orange-50 pb-20",children:[(0,a.jsxs)("main",{className:"container mx-auto px-3 py-3 sm:px-4 sm:py-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"relative mb-2.5",children:[(0,a.jsx)(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,a.jsx)(S.Input,{placeholder:"Buscar por nome, raça, localidade...",className:"pl-9 h-9 text-sm sm:h-10",value:b,onChange:e=>C(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(f.Select,{value:D,onValueChange:e=>I(e),children:[(0,a.jsx)(f.SelectTrigger,{className:"flex-1 h-9 text-sm sm:h-10",children:(0,a.jsx)(f.SelectValue,{})}),(0,a.jsxs)(f.SelectContent,{children:[(0,a.jsx)(f.SelectItem,{value:"all",children:"Todos"}),(0,a.jsx)(f.SelectItem,{value:"lost",children:"Perdidos"}),(0,a.jsx)(f.SelectItem,{value:"found",children:"Encontrados"}),(0,a.jsx)(f.SelectItem,{value:"adoption",children:"Adoção"})]})]}),(0,a.jsxs)(f.Select,{value:A,onValueChange:e=>P(e),children:[(0,a.jsx)(f.SelectTrigger,{className:"flex-1 h-9 text-sm sm:h-10",children:(0,a.jsx)(f.SelectValue,{})}),(0,a.jsxs)(f.SelectContent,{children:[(0,a.jsx)(f.SelectItem,{value:"all",children:"Todos tipos"}),(0,a.jsx)(f.SelectItem,{value:"dog",children:"Cachorro"}),(0,a.jsx)(f.SelectItem,{value:"cat",children:"Gato"}),(0,a.jsx)(f.SelectItem,{value:"other",children:"Outro"})]})]})]})]}),j?(0,a.jsx)("div",{className:"text-center py-12",children:"Carregando publicações..."}):0===p.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Nenhum pet encontrado com os filtros selecionados"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4",children:p.map(e=>(0,a.jsx)(o.PetCard,{pet:e,onViewSightings:T,onReportSighting:O,onViewMap:B,onShare:L,onReport:q},e.id))})]}),(0,a.jsx)(i.SightingDialog,{pet:k,open:!!k,onClose:()=>O(null),onSubmit:e=>{if(k){let a={id:`s${Date.now()}`,petId:k.id,...e,createdAt:new Date};h(e=>e.map(e=>e.id===k.id?{...e,sightings:[...e.sightings,a]}:e)),alert("Avistamento reportado com sucesso!")}}}),(0,a.jsx)(c.ViewSightingsDialog,{pet:R,open:!!R,onClose:()=>T(null)}),(0,a.jsx)(g,{pet:E,open:!!E,onClose:()=>L(null)}),(0,a.jsx)(N,{pet:_,open:!!_,onClose:()=>q(null)}),(0,a.jsx)(w.MobileNav,{})]}):null}e.s(["default",()=>C],31713)},66997,e=>{e.v(a=>Promise.all(["static/chunks/cf4fc1e20e39d4cb.js"].map(a=>e.l(a))).then(()=>a(21487)))}]);