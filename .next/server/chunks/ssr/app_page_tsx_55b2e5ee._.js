module.exports=[60350,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(1470),e=a.i(21937),f=a.i(53250);function g(a){let b=a.fotos_urls,c="/placeholder-pet.png";if(Array.isArray(b)&&b.length>0)c=b[0];else if("string"==typeof b&&b.length>0)c=b;else if(b&&"object"==typeof b&&Object.keys(b).length>0){let a=Object.values(b);a.length>0&&(c=String(a[0]))}let d=(a.avistamentos||[]).map(b=>({id:String(b.id),petId:String(a.id),location:{lat:Number(b.latitude),lng:Number(b.longitude),address:b.endereco_texto||"",city:"",neighborhood:""},date:b.data_avistamento?new Date(b.data_avistamento):new Date,time:b.data_avistamento?new Date(b.data_avistamento).toLocaleTimeString():"",description:b.observacoes||"",reporterName:b.usuario?.nome||"",reporterPhone:b.usuario?.telefone||"",createdAt:b.data_avistamento?new Date(b.data_avistamento):new Date}));return{id:String(a.id),userId:a.usuarioId||a.usuario&&a.usuario.id||"",status:function(a){switch(a){case"PERDIDO":default:return"lost";case"ENCONTRADO":return"found";case"ADOCAO":return"adoption"}}(a.tipo),name:a.nome_pet||a.titulo||void 0,type:function(a){switch(a){case"CACHORRO":return"dog";case"GATO":return"cat";default:return"other"}}(a.especie),breed:a.raca||"",size:function(a){switch(a){case"PEQUENO":return"small";case"MEDIO":default:return"medium";case"GRANDE":return"large"}}(a.porte),age:a.idade?String(a.idade):void 0,location:{lat:Number(a.latitude),lng:Number(a.longitude),address:a.endereco_texto||"",city:"",neighborhood:""},lastSeenDate:a.data_evento?new Date(a.data_evento):a.data_publicacao?new Date(a.data_publicacao):new Date,description:a.descricao||"",photoUrl:c,reward:void 0,contactPhone:a.usuario?.telefone||"",contactName:a.usuario?.nome||"",sightings:d,createdAt:a.data_publicacao?new Date(a.data_publicacao):new Date}}var h=a.i(41581),i=a.i(43751),j=a.i(77011),k=a.i(65733),l=a.i(40695),m=a.i(61237);let n=(0,m.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var o=a.i(4328),p=a.i(80028);function q({pet:d,open:e,onClose:f}){let g=(0,c.useRef)(null);if(!d)return null;let h={lost:{label:"PERDIDO",color:"bg-red-600",datePrefix:"Perdido em"},found:{label:"ENCONTRADO",color:"bg-blue-600",datePrefix:"Encontrado em"},adoption:{label:"PARA ADOÇÃO",color:"bg-green-600",datePrefix:"Disponível desde"}}[d.status],i=async()=>{if(g.current)try{let b=(await a.A(23144)).default,c=await b(g.current,{scale:2,backgroundColor:"#ffffff"}),e=document.createElement("a");e.download=`poster-${d.name||"pet"}-${d.id}.png`,e.href=c.toDataURL("image/png"),e.click()}catch(a){alert("Erro ao gerar poster. Por favor, tente novamente.")}},j=async b=>{if(g.current)try{let c=(await a.A(23144)).default,e=await c(g.current,{scale:2,backgroundColor:"#ffffff"});e.toBlob(async a=>{if(!a)return;new File([a],`poster-${d.name||"pet"}.png`,{type:"image/png"});let c=`${h.label}: ${d.name||"Pet sem nome"}
${d.breed}
${d.location.city}
Contato: ${d.contactPhone}`;if("whatsapp"===b){let a=encodeURIComponent(c);window.open(`https://wa.me/?text=${a}`,"_blank")}else if("facebook"===b)window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`,"_blank");else if("instagram"===b){let a=document.createElement("a");a.download=`poster-${d.name||"pet"}-instagram.png`,a.href=e.toDataURL("image/png"),a.click(),alert("Imagem baixada! Agora você pode compartilhar no Instagram.")}})}catch(a){alert("Erro ao compartilhar. Por favor, tente novamente.")}};return(0,b.jsx)(k.Dialog,{open:e,onOpenChange:f,children:(0,b.jsxs)(k.DialogContent,{className:"max-w-sm md:max-w-md max-h-[90vh] overflow-auto",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Compartilhar Anúncio"}),(0,b.jsx)(k.DialogDescription,{children:"Baixe o poster ou compartilhe nas redes sociais"})]}),(0,b.jsxs)("div",{ref:g,className:"bg-white rounded-lg overflow-hidden border-2 border-gray-800",children:[(0,b.jsx)("div",{className:`${h.color} text-white text-center py-3`,children:(0,b.jsx)("h2",{className:"text-2xl font-black",children:h.label})}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"relative aspect-square rounded-lg overflow-hidden mb-3",children:(0,b.jsx)(p.default,{src:d.photoUrl||"/placeholder.svg",alt:d.name||"Pet",fill:!0,className:"object-cover"})}),d.name&&(0,b.jsx)("h3",{className:"text-2xl font-bold text-center mb-4",children:d.name}),(0,b.jsxs)("div",{className:"space-y-2.5 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Raça:"}),(0,b.jsx)("span",{children:d.breed})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t pt-2.5",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Local:"}),(0,b.jsx)("span",{children:d.location.city})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t pt-2.5",children:[(0,b.jsxs)("span",{className:"font-semibold",children:[h.datePrefix,":"]}),(0,b.jsx)("span",{children:new Date(d.lastSeenDate).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),d.reward&&(0,b.jsx)("div",{className:"border-t pt-2.5",children:(0,b.jsxs)("p",{className:"text-center text-lg font-bold text-amber-600",children:["RECOMPENSA: R$ ",d.reward]})}),(0,b.jsxs)("div",{className:"border-t pt-2.5 text-center",children:[(0,b.jsx)("p",{className:"font-semibold mb-1",children:"CONTATO"}),(0,b.jsx)("p",{className:"text-lg font-bold",children:d.contactPhone}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:d.contactName})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(l.Button,{onClick:i,className:"w-full",children:[(0,b.jsx)(n,{className:"w-4 h-4 mr-2"}),"Baixar Poster (PNG)"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-center",children:"Compartilhar em:"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,b.jsxs)(l.Button,{onClick:()=>j("whatsapp"),className:"bg-green-600 hover:bg-green-700 h-10 text-xs",children:[(0,b.jsx)(o.Share2,{className:"w-3 h-3 mr-1"}),"WhatsApp"]}),(0,b.jsxs)(l.Button,{onClick:()=>j("facebook"),className:"bg-blue-600 hover:bg-blue-700 h-10 text-xs",children:[(0,b.jsx)(o.Share2,{className:"w-3 h-3 mr-1"}),"Facebook"]}),(0,b.jsxs)(l.Button,{onClick:()=>j("instagram"),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 h-10 text-xs",children:[(0,b.jsx)(o.Share2,{className:"w-3 h-3 mr-1"}),"Instagram"]})]})]})]})]})})}var r=a.i(17171),s=a.i(46893),t=a.i(87682);let u=(0,m.default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function v({pet:a,open:d,onClose:e}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(""),[j,m]=(0,c.useState)(!1),n=async a=>{a.preventDefault(),m(!0),await new Promise(a=>setTimeout(a,1500)),alert("Denúncia enviada com sucesso. Nossa equipe irá analisar."),g(""),i(""),m(!1),e()};return a?(0,b.jsx)(k.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(k.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsxs)(k.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(u,{className:"w-5 h-5 text-amber-600"}),"Denunciar Publicação"]}),(0,b.jsx)(k.DialogDescription,{children:"Informe o motivo da denúncia. Nossa equipe analisará o caso."})]}),(0,b.jsxs)("form",{onSubmit:n,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"reason",className:"text-sm",children:"Motivo da denúncia *"}),(0,b.jsxs)(t.Select,{value:f,onValueChange:g,required:!0,children:[(0,b.jsx)(t.SelectTrigger,{id:"reason",className:"text-sm",children:(0,b.jsx)(t.SelectValue,{placeholder:"Selecione o motivo"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"fake",children:"Anúncio falso ou enganoso"}),(0,b.jsx)(t.SelectItem,{value:"inappropriate",children:"Conteúdo inapropriado"}),(0,b.jsx)(t.SelectItem,{value:"spam",children:"Spam ou propaganda"}),(0,b.jsx)(t.SelectItem,{value:"abuse",children:"Maus tratos ao animal"}),(0,b.jsx)(t.SelectItem,{value:"duplicate",children:"Publicação duplicada"}),(0,b.jsx)(t.SelectItem,{value:"scam",children:"Tentativa de golpe"}),(0,b.jsx)(t.SelectItem,{value:"other",children:"Outro motivo"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{htmlFor:"details",className:"text-sm",children:"Detalhes adicionais (opcional)"}),(0,b.jsx)(s.Textarea,{id:"details",value:h,onChange:a=>i(a.target.value),placeholder:"Forneça mais informações sobre a denúncia...",rows:4,className:"text-sm resize-none"})]}),(0,b.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,b.jsx)("p",{className:"text-xs text-amber-800",children:"Denúncias falsas ou mal-intencionadas podem resultar em suspensão da conta. Por favor, denuncie apenas conteúdo que viole nossas diretrizes."})}),(0,b.jsxs)(k.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,b.jsx)(l.Button,{type:"button",variant:"outline",onClick:e,className:"text-sm",children:"Cancelar"}),(0,b.jsx)(l.Button,{type:"submit",disabled:!f||j,variant:"destructive",className:"text-sm",children:j?"Enviando...":"Enviar Denúncia"})]})]})]})}):null}var w=a.i(68058),x=a.i(5522);let y=(0,m.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);function z(){let{user:a,isLoading:k}=(0,e.useAuth)(),l=(0,d.useRouter)(),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[r,s]=(0,c.useState)(!1),[u,z]=(0,c.useState)(""),[A,B]=(0,c.useState)("all"),[C,D]=(0,c.useState)("all"),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null);(0,c.useEffect)(()=>{k||a||l.push("/login")},[a,k,l]),(0,c.useEffect)(()=>{let a=!0;return async function(){s(!0);try{let b=(await (0,f.apiFetch)("/api/publicacoes")).map(g);a&&(n(b),p(b))}catch(a){console.error("Failed to load publicacoes",a)}finally{s(!1)}}(),()=>{a=!1}},[]),(0,c.useEffect)(()=>{let a=m;u&&(a=a.filter(a=>a.name?.toLowerCase().includes(u.toLowerCase())||a.breed.toLowerCase().includes(u.toLowerCase())||a.location.address.toLowerCase().includes(u.toLowerCase())||a.location.city.toLowerCase().includes(u.toLowerCase()))),"all"!==A&&(a=a.filter(a=>a.status===A)),"all"!==C&&(a=a.filter(a=>a.type===C)),p(a)},[u,A,C,m]);let M=a=>{l.push(`/map?petId=${a.id}`)};return k?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Carregando..."})]})}):a?(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-orange-50 pb-20",children:[(0,b.jsxs)("main",{className:"container mx-auto px-3 py-3 sm:px-4 sm:py-6",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"relative mb-2.5",children:[(0,b.jsx)(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,b.jsx)(x.Input,{placeholder:"Buscar por nome, raça, localidade...",className:"pl-9 h-9 text-sm sm:h-10",value:u,onChange:a=>z(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(t.Select,{value:A,onValueChange:a=>B(a),children:[(0,b.jsx)(t.SelectTrigger,{className:"flex-1 h-9 text-sm sm:h-10",children:(0,b.jsx)(t.SelectValue,{})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"Todos"}),(0,b.jsx)(t.SelectItem,{value:"lost",children:"Perdidos"}),(0,b.jsx)(t.SelectItem,{value:"found",children:"Encontrados"}),(0,b.jsx)(t.SelectItem,{value:"adoption",children:"Adoção"})]})]}),(0,b.jsxs)(t.Select,{value:C,onValueChange:a=>D(a),children:[(0,b.jsx)(t.SelectTrigger,{className:"flex-1 h-9 text-sm sm:h-10",children:(0,b.jsx)(t.SelectValue,{})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"Todos tipos"}),(0,b.jsx)(t.SelectItem,{value:"dog",children:"Cachorro"}),(0,b.jsx)(t.SelectItem,{value:"cat",children:"Gato"}),(0,b.jsx)(t.SelectItem,{value:"other",children:"Outro"})]})]})]})]}),r?(0,b.jsx)("div",{className:"text-center py-12",children:"Carregando publicações..."}):0===o.length?(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Nenhum pet encontrado com os filtros selecionados"})}):(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4",children:o.map(a=>(0,b.jsx)(h.PetCard,{pet:a,onViewSightings:H,onReportSighting:F,onViewMap:M,onShare:J,onReport:L},a.id))})]}),(0,b.jsx)(i.SightingDialog,{pet:E,open:!!E,onClose:()=>F(null),onSubmit:a=>{if(E){let b={id:`s${Date.now()}`,petId:E.id,...a,createdAt:new Date};n(a=>a.map(a=>a.id===E.id?{...a,sightings:[...a.sightings,b]}:a)),alert("Avistamento reportado com sucesso!")}}}),(0,b.jsx)(j.ViewSightingsDialog,{pet:G,open:!!G,onClose:()=>H(null)}),(0,b.jsx)(q,{pet:I,open:!!I,onClose:()=>J(null)}),(0,b.jsx)(v,{pet:K,open:!!K,onClose:()=>L(null)}),(0,b.jsx)(w.MobileNav,{})]}):null}a.s(["default",()=>z],60350)}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map