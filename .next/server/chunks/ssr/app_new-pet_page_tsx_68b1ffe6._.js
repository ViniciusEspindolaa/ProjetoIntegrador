module.exports=[34429,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(1470),e=a.i(21937),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(46893),j=a.i(87682),k=a.i(3130),l=a.i(11374),m=a.i(97568),n=a.i(32267),o=a.i(19113),p=a.i(80028);let q=(0,a.i(36740).default)(async()=>{},{loadableGenerated:{modules:[78264]},ssr:!1});function r(){let{user:a,isLoading:r}=(0,e.useAuth)(),s=(0,d.useRouter)(),[t,u]=(0,c.useState)("lost"),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)("dog"),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)("medium"),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(""),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)([]),[V,W]=(0,c.useState)(""),[X,Y]=(0,c.useState)(""),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(!1);(0,c.useEffect)(()=>{r||a||s.push("/login")},[a,r,s]);let ad=async()=>{if(P&&!(P.trim().length<3)){S(!0);try{let a=encodeURIComponent(P),b=await fetch(`https://nominatim.openstreetmap.org/search?q=${a}&format=json&limit=8&addressdetails=1`),c=(await b.json()||[]).filter(a=>{let b=a.address||{},c=!!(b.road||b.pedestrian||b.footway||b.cycleway||b.house_number),d=!!(b.city||b.town||b.village||b.county||b.state);return c&&d});U(c)}catch(a){console.error("Erro ao buscar endereço",a),U([])}finally{S(!1)}}};function ae(a){let b=a.address||{},c=b.road||b.pedestrian||b.footway||b.cycleway||"";b.house_number&&(c=c?`${c}, ${b.house_number}`:`${b.house_number}`);let d=b.city||b.town||b.village||b.county||b.state||"",e=[];return c&&e.push(c),d&&e.push(d),e.length?e.join(", "):a.display_name||""}(0,c.useEffect)(()=>{(async()=>{if(N)try{let a=await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${N.lat}&lon=${N.lng}&format=json&addressdetails=1`),b=await a.json(),c=b?.address||{},d=c.road||c.pedestrian||c.footway||c.cycleway||"",e=c.house_number||"",f=e?d?`${d}, ${e}`:e:d;G(f||"");let g=c.neighbourhood||c.suburb||c.village||c.hamlet||"";K(g);let h=c.city||c.town||c.village||c.county||c.state||"";I(h)}catch(a){console.error("Erro no reverse geocoding",a)}})()},[N]);let af=async b=>{if(b.preventDefault(),aa(!0),!N){alert('Selecione a localização no mapa ou use "Usar Minha Localização Atual" antes de publicar.'),aa(!1);return}try{let b={usuarioId:a?.id,titulo:`${"lost"===t?"Pet perdido":"found"===t?"Pet encontrado":"Pet para adoção"} - ${v||z||"Sem nome"}`,descricao:V,fotos_urls:[],latitude:Number(N.lat),longitude:Number(N.lng),endereco_texto:F||T[0]?.display_name||"",bairro:J||void 0,tipo:{lost:"PERDIDO",found:"ENCONTRADO",adoption:"ADOCAO"}[t]||"PERDIDO",especie:{dog:"CACHORRO",cat:"GATO",other:"OUTRO"}[x]||"OUTRO",nome_pet:v||void 0,raca:z||void 0,porte:{small:"PEQUENO",medium:"MEDIO",large:"GRANDE"}[B]||void 0,idade:parseInt(D)||void 0,data_evento:L||new Date().toISOString()};await apiFetch("/api/publicacoes",{method:"POST",body:JSON.stringify(b)}),alert("Pet cadastrado com sucesso!"),s.push("/")}catch(a){console.error("Erro ao criar publicação",a),alert(`Erro ao publicar: ${a?.message||"verifique o console"}`)}finally{aa(!1)}};return r?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Carregando..."})]})}):a?(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-orange-50 pb-6",children:(0,b.jsxs)("main",{className:"container mx-auto px-3 py-3 sm:px-4 sm:py-6 max-w-2xl",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>s.push("/"),className:"p-2 h-auto",children:(0,b.jsx)(l.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-base sm:text-xl font-bold",children:"Novo Anúncio"}),(0,b.jsx)("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Preencha as informações do pet"})]})]}),(0,b.jsxs)("form",{onSubmit:af,className:"space-y-3 sm:space-y-6",children:[(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4",children:[(0,b.jsx)(h.Label,{htmlFor:"status",className:"mb-2 block text-sm",children:"Tipo de anúncio *"}),(0,b.jsxs)(j.Select,{value:t,onValueChange:a=>u(a),children:[(0,b.jsx)(j.SelectTrigger,{id:"status",className:"h-9 text-sm sm:h-10",children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"lost",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),(0,b.jsx)("span",{children:"Perdido - Meu pet desapareceu"})]})}),(0,b.jsx)(j.SelectItem,{value:"found",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,b.jsx)("span",{children:"Encontrado - Encontrei um pet"})]})}),(0,b.jsx)(j.SelectItem,{value:"adoption",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,b.jsx)("span",{children:"Adoção - Pet para adotar"})]})})]})]})]})}),(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4",children:[(0,b.jsx)(h.Label,{className:"mb-2 block text-sm",children:"Foto do pet *"}),Z?(0,b.jsxs)("div",{className:"relative aspect-video rounded-lg overflow-hidden",children:[(0,b.jsx)(p.default,{src:Z||"/placeholder.svg",alt:"Preview",fill:!0,className:"object-cover"}),(0,b.jsx)("button",{type:"button",onClick:()=>$(null),className:"absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 active:scale-95",children:(0,b.jsx)(n.X,{className:"w-4 h-4"})})]}):(0,b.jsxs)("label",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 sm:p-8 flex flex-col items-center justify-center cursor-pointer hover:border-gray-400 transition-colors active:bg-gray-50",children:[(0,b.jsx)(m.Upload,{className:"w-10 h-10 text-gray-400 mb-2"}),(0,b.jsx)("p",{className:"text-sm font-medium mb-0.5",children:"Clique para enviar uma foto"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG até 10MB"}),(0,b.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:a=>{let b=a.target.files?.[0];if(b){let a=new FileReader;a.onloadend=()=>{$(a.result)},a.readAsDataURL(b)}},required:!0})]})]})}),(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm",children:"Informações do Pet"}),("lost"===t||"adoption"===t)&&(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(h.Label,{htmlFor:"name",className:"text-xs sm:text-sm",children:["Nome ","lost"===t?"*":"(opcional)"]}),(0,b.jsx)(g.Input,{id:"name",placeholder:"Ex: Rex, Luna...",value:v,onChange:a=>w(a.target.value),required:"lost"===t,className:"h-9 text-sm"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2.5 sm:gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"type",className:"text-xs sm:text-sm",children:"Tipo *"}),(0,b.jsxs)(j.Select,{value:x,onValueChange:a=>y(a),children:[(0,b.jsx)(j.SelectTrigger,{id:"type",className:"h-9 text-sm",children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"dog",children:"Cachorro"}),(0,b.jsx)(j.SelectItem,{value:"cat",children:"Gato"}),(0,b.jsx)(j.SelectItem,{value:"other",children:"Outro"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"size",className:"text-xs sm:text-sm",children:"Porte *"}),(0,b.jsxs)(j.Select,{value:B,onValueChange:a=>C(a),children:[(0,b.jsx)(j.SelectTrigger,{id:"size",className:"h-9 text-sm",children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"small",children:"Pequeno"}),(0,b.jsx)(j.SelectItem,{value:"medium",children:"Médio"}),(0,b.jsx)(j.SelectItem,{value:"large",children:"Grande"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2.5 sm:gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"breed",className:"text-xs sm:text-sm",children:"Raça *"}),(0,b.jsx)(g.Input,{id:"breed",placeholder:"Ex: Labrador, Siamês...",value:z,onChange:a=>A(a.target.value),required:!0,className:"h-9 text-sm"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"age",className:"text-xs sm:text-sm",children:"Idade (opcional)"}),(0,b.jsx)(g.Input,{id:"age",placeholder:"Ex: 3 anos, 6 meses...",value:D,onChange:a=>E(a.target.value),className:"h-9 text-sm"})]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"eventDate",className:"text-xs sm:text-sm",children:"lost"===t?"Data em que se perdeu *":"found"===t?"Data em que foi encontrado *":"Disponível desde (opcional)"}),(0,b.jsx)(g.Input,{id:"eventDate",type:"date",value:L,onChange:a=>M(a.target.value),required:"adoption"!==t,className:"h-9 text-sm",max:new Date().toISOString().split("T")[0]})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"description",className:"text-xs sm:text-sm",children:"Descrição *"}),(0,b.jsx)(i.Textarea,{id:"description",placeholder:"lost"===t?"Descreva características marcantes, comportamento, onde foi visto pela última vez...":"found"===t?"Descreva onde encontrou o pet, características marcantes...":"Descreva o temperamento, se está vacinado, castrado...",value:V,onChange:a=>W(a.target.value),required:!0,rows:4,className:"text-sm resize-none"})]})]})}),(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm",children:"Localização"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"lost"===t?"Onde o pet foi visto pela última vez?":"found"===t?"Onde o pet foi encontrado?":"Onde o pet está localizado?"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",placeholder:"Buscar endereço (ex: Rua, bairro, cidade)",value:P,onChange:a=>Q(a.target.value),className:"flex-1 border rounded px-2 py-1 text-sm"}),(0,b.jsx)("button",{type:"button",onClick:ad,className:"bg-slate-100 px-3 rounded text-sm",children:R?"Buscando...":"Buscar"})]}),T.length>0&&(0,b.jsx)("div",{className:"max-h-40 overflow-auto mb-2 border rounded p-2 bg-white",children:T.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{O({lat:parseFloat(a.lat),lng:parseFloat(a.lon)}),G(ae(a));let b=a.address||{};K(b.neighbourhood||b.suburb||b.village||b.hamlet||""),I(b.city||b.town||b.village||b.county||b.state||""),U([])},className:"w-full text-left p-1 text-sm hover:bg-slate-50",children:ae(a)},a.place_id))}),(0,b.jsx)(q,{latitude:N?.lat??null,longitude:N?.lng??null,onChange:(a,b)=>{O({lat:a,lng:b})}}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsxs)(f.Button,{type:"button",variant:"outline",onClick:()=>{ac(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{let{latitude:b,longitude:c}=a.coords;O({lat:b,lng:c}),ac(!1),alert(`Localiza\xe7\xe3o capturada: ${b.toFixed(6)}, ${c.toFixed(6)}`)},a=>{ac(!1),alert("Não foi possível obter sua localização. Verifique as permissões do navegador.")}):(ac(!1),alert("Geolocalização não é suportada pelo seu navegador."))},disabled:ab,className:"w-full h-9 text-sm",children:[(0,b.jsx)(o.MapPin,{className:"w-4 h-4 mr-2"}),ab?"Obtendo localização...":"Usar Minha Localização Atual"]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-2.5",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"location",className:"text-xs sm:text-sm",children:"Endereço (rua) *"}),(0,b.jsx)(g.Input,{id:"location",placeholder:"Ex: Av. Paulista, 1000",value:F,onChange:a=>G(a.target.value),required:!0,className:"h-9 text-sm"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2.5",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"neighborhood",className:"text-xs sm:text-sm",children:"Bairro"}),(0,b.jsx)(g.Input,{id:"neighborhood",placeholder:"Ex: Bela Vista",value:J,onChange:a=>K(a.target.value),className:"h-9 text-sm"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"city",className:"text-xs sm:text-sm",children:"Cidade *"}),(0,b.jsx)(g.Input,{id:"city",placeholder:"Ex: São Paulo",value:H,onChange:a=>I(a.target.value),required:!0,className:"h-9 text-sm"})]})]})]})]}),N&&(0,b.jsx)("div",{className:"p-2 bg-green-50 border border-green-200 rounded-md",children:(0,b.jsxs)("p",{className:"text-xs text-green-800",children:["✓ Localização capturada: ",N.lat.toFixed(6),", ",N.lng.toFixed(6)]})}),(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"A localização no mapa ajuda outros usuários a visualizar exatamente onde o pet foi visto."})]})}),"lost"===t&&(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm",children:"Recompensa (opcional)"}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{htmlFor:"reward",className:"text-xs sm:text-sm",children:"Valor da recompensa"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground text-sm",children:"R$"}),(0,b.jsx)(g.Input,{id:"reward",type:"number",placeholder:"0,00",className:"pl-10 h-9 text-sm",value:X,onChange:a=>Y(a.target.value)})]})]})]})}),(0,b.jsx)(k.Card,{children:(0,b.jsxs)(k.CardContent,{className:"p-3 sm:p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm",children:"Contato"}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{className:"text-xs sm:text-sm",children:"Nome"}),(0,b.jsx)(g.Input,{value:a.name,disabled:!0,className:"h-9 text-sm"})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(h.Label,{className:"text-xs sm:text-sm",children:"Telefone (WhatsApp)"}),(0,b.jsx)(g.Input,{value:a.phone,disabled:!0,className:"h-9 text-sm"})]}),(0,b.jsx)("p",{className:"text-[10px] sm:text-sm text-muted-foreground",children:"Estas informações serão usadas para contato. Para alterá-las, vá em Perfil."})]})}),(0,b.jsx)(f.Button,{type:"submit",className:"w-full h-10 text-sm font-semibold sm:h-12",disabled:_,children:_?"Publicando...":"Publicar Anúncio"})]})]})}):null}a.s(["default",()=>r])}];

//# sourceMappingURL=app_new-pet_page_tsx_68b1ffe6._.js.map