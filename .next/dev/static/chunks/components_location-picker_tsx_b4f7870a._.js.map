{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vinic.VINICIUS/Desktop/PetFinder/Frontend/components/location-picker.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { useState, useEffect, useMemo } from 'react'\r\nimport { MapContainer, TileLayer, Marker, useMapEvents, useMap } from 'react-leaflet'\r\nimport { Button } from '@/components/ui/button'\r\nimport { MapPin, Locate } from 'lucide-react'\r\nimport L from 'leaflet'\r\n\r\n// Ensure marker icons load correctly\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n})\r\n\r\ninterface LocationPickerProps {\r\n  initialLat?: number\r\n  initialLng?: number\r\n  onLocationSelect: (lat: number, lng: number) => void\r\n}\r\n\r\nfunction LocationMarker({ position, setPosition, onLocationSelect }: { \r\n  position: { lat: number, lng: number } | null, \r\n  setPosition: (pos: { lat: number, lng: number }) => void,\r\n  onLocationSelect: (lat: number, lng: number) => void\r\n}) {\r\n  const map = useMap()\r\n\r\n  useMapEvents({\r\n    click(e) {\r\n      setPosition(e.latlng)\r\n      onLocationSelect(e.latlng.lat, e.latlng.lng)\r\n    },\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (position) {\r\n      map.flyTo(position, map.getZoom())\r\n    }\r\n  }, [position, map])\r\n\r\n  const customIcon = L.divIcon({\r\n    html: `\r\n      <svg width=\"36\" height=\"36\" viewBox=\"0 0 36 36\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <defs>\r\n          <filter id=\"pinShadow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\r\n            <feDropShadow dx=\"0\" dy=\"1\" stdDeviation=\"1.2\" flood-color=\"#000\" flood-opacity=\"0.25\" />\r\n          </filter>\r\n        </defs>\r\n        <g filter=\"url(#pinShadow)\">\r\n          <path d=\"M18 2 C12 2 8 6 8 12 C8 20 18 32 18 32 C18 32 28 20 28 12 C28 6 24 2 18 2 Z\" fill=\"#ef4444\" stroke=\"#ffffff\" stroke-width=\"1.6\"/>\r\n          <circle cx=\"18\" cy=\"12\" r=\"5\" fill=\"#ffffff\" />\r\n        </g>\r\n      </svg>\r\n    `,\r\n    className: 'custom-div-icon',\r\n    iconSize: [36, 36],\r\n    iconAnchor: [18, 34],\r\n  })\r\n\r\n  return position === null ? null : (\r\n    <Marker position={position} icon={customIcon}></Marker>\r\n  )\r\n}\r\n\r\nfunction MapController({ onLocate }: { onLocate: () => void }) {\r\n  return (\r\n    <div className=\"leaflet-top leaflet-right\" style={{ top: '10px', right: '10px' }}>\r\n      <div className=\"leaflet-control leaflet-bar\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"bg-white hover:bg-gray-100 text-gray-800 p-2 border border-gray-400 rounded shadow flex items-center justify-center w-10 h-10\"\r\n          onClick={(e) => {\r\n            e.preventDefault()\r\n            e.stopPropagation()\r\n            onLocate()\r\n          }}\r\n          title=\"Usar minha localização\"\r\n        >\r\n          <Locate className=\"w-5 h-5\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default function LocationPicker({ initialLat, initialLng, onLocationSelect }: LocationPickerProps) {\r\n  const [position, setPosition] = useState<{ lat: number, lng: number } | null>(null)\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    // Inject Leaflet CSS\r\n    if (typeof window !== 'undefined' && !document.getElementById('leaflet-css')) {\r\n      const link = document.createElement('link')\r\n      link.id = 'leaflet-css'\r\n      link.rel = 'stylesheet'\r\n      link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'\r\n      document.head.appendChild(link)\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (initialLat !== undefined && initialLng !== undefined) {\r\n      const lat = Number(initialLat)\r\n      const lng = Number(initialLng)\r\n      if (!isNaN(lat) && !isNaN(lng)) {\r\n        setPosition({ lat, lng })\r\n      }\r\n    }\r\n  }, [initialLat, initialLng])\r\n\r\n  const handleLocate = () => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (pos) => {\r\n          const newPos = { lat: pos.coords.latitude, lng: pos.coords.longitude }\r\n          setPosition(newPos)\r\n          onLocationSelect(newPos.lat, newPos.lng)\r\n        },\r\n        (err) => {\r\n          console.error(\"Error getting location\", err)\r\n          alert(\"Não foi possível obter sua localização.\")\r\n        }\r\n      )\r\n    } else {\r\n      alert(\"Geolocalização não suportada pelo navegador.\")\r\n    }\r\n  }\r\n\r\n  if (!mounted) return <div className=\"w-full h-[300px] bg-gray-100 animate-pulse rounded-lg flex items-center justify-center text-gray-400\">Carregando mapa...</div>\r\n\r\n  // Default center (São Paulo) if no position\r\n  const center = position || { lat: -23.5505, lng: -46.6333 }\r\n\r\n  return (\r\n    <div className=\"w-full h-[300px] rounded-lg overflow-hidden border border-gray-200 relative z-0\">\r\n      <MapContainer \r\n        center={center} \r\n        zoom={13} \r\n        style={{ height: '100%', width: '100%' }}\r\n      >\r\n        <TileLayer\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n        />\r\n        <LocationMarker position={position} setPosition={setPosition} onLocationSelect={onLocationSelect} />\r\n        <MapController onLocate={handleLocate} />\r\n      </MapContainer>\r\n      \r\n      {!position && (\r\n        <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-white/90 px-4 py-2 rounded-full shadow-lg text-sm font-medium text-gray-600 pointer-events-none z-[1000]\">\r\n          Toque no mapa para selecionar\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;;;AANA;;;;;AAQA,qCAAqC;AACrC,+JAAC,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC;IAC1B,eAAe;IACf,SAAS;IACT,WAAW;AACb;AAQA,SAAS,eAAe,EAAE,QAAQ,EAAE,WAAW,EAAE,gBAAgB,EAIhE;;IACC,MAAM,MAAM,IAAA,6JAAM;IAElB,IAAA,mKAAY,EAAC;QACX,OAAM,CAAC;YACL,YAAY,EAAE,MAAM;YACpB,iBAAiB,EAAE,MAAM,CAAC,GAAG,EAAE,EAAE,MAAM,CAAC,GAAG;QAC7C;IACF;IAEA,IAAA,0KAAS;oCAAC;YACR,IAAI,UAAU;gBACZ,IAAI,KAAK,CAAC,UAAU,IAAI,OAAO;YACjC;QACF;mCAAG;QAAC;QAAU;KAAI;IAElB,MAAM,aAAa,+JAAC,CAAC,OAAO,CAAC;QAC3B,MAAM,CAAC;;;;;;;;;;;;IAYP,CAAC;QACD,WAAW;QACX,UAAU;YAAC;YAAI;SAAG;QAClB,YAAY;YAAC;YAAI;SAAG;IACtB;IAEA,OAAO,aAAa,OAAO,qBACzB,6LAAC,8JAAM;QAAC,UAAU;QAAU,MAAM;;;;;;AAEtC;GA1CS;;QAKK,6JAAM;QAElB,mKAAY;;;KAPL;AA4CT,SAAS,cAAc,EAAE,QAAQ,EAA4B;IAC3D,qBACE,6LAAC;QAAI,WAAU;QAA4B,OAAO;YAAE,KAAK;YAAQ,OAAO;QAAO;kBAC7E,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBACC,MAAK;gBACL,WAAU;gBACV,SAAS,CAAC;oBACR,EAAE,cAAc;oBAChB,EAAE,eAAe;oBACjB;gBACF;gBACA,OAAM;0BAEN,cAAA,6LAAC,mNAAM;oBAAC,WAAU;;;;;;;;;;;;;;;;;;;;;AAK5B;MAnBS;AAqBM,SAAS,eAAe,EAAE,UAAU,EAAE,UAAU,EAAE,gBAAgB,EAAuB;;IACtG,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAsC;IAC9E,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;oCAAC;YACR,WAAW;YACX,qBAAqB;YACrB,IAAI,+CAAkB,eAAe,CAAC,SAAS,cAAc,CAAC,gBAAgB;gBAC5E,MAAM,OAAO,SAAS,aAAa,CAAC;gBACpC,KAAK,EAAE,GAAG;gBACV,KAAK,GAAG,GAAG;gBACX,KAAK,IAAI,GAAG;gBACZ,SAAS,IAAI,CAAC,WAAW,CAAC;YAC5B;QACF;mCAAG,EAAE;IAEL,IAAA,0KAAS;oCAAC;YACR,IAAI,eAAe,aAAa,eAAe,WAAW;gBACxD,MAAM,MAAM,OAAO;gBACnB,MAAM,MAAM,OAAO;gBACnB,IAAI,CAAC,MAAM,QAAQ,CAAC,MAAM,MAAM;oBAC9B,YAAY;wBAAE;wBAAK;oBAAI;gBACzB;YACF;QACF;mCAAG;QAAC;QAAY;KAAW;IAE3B,MAAM,eAAe;QACnB,IAAI,UAAU,WAAW,EAAE;YACzB,UAAU,WAAW,CAAC,kBAAkB,CACtC,CAAC;gBACC,MAAM,SAAS;oBAAE,KAAK,IAAI,MAAM,CAAC,QAAQ;oBAAE,KAAK,IAAI,MAAM,CAAC,SAAS;gBAAC;gBACrE,YAAY;gBACZ,iBAAiB,OAAO,GAAG,EAAE,OAAO,GAAG;YACzC,GACA,CAAC;gBACC,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,MAAM;YACR;QAEJ,OAAO;YACL,MAAM;QACR;IACF;IAEA,IAAI,CAAC,SAAS,qBAAO,6LAAC;QAAI,WAAU;kBAAuG;;;;;;IAE3I,4CAA4C;IAC5C,MAAM,SAAS,YAAY;QAAE,KAAK,CAAC;QAAS,KAAK,CAAC;IAAQ;IAE1D,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,0KAAY;gBACX,QAAQ;gBACR,MAAM;gBACN,OAAO;oBAAE,QAAQ;oBAAQ,OAAO;gBAAO;;kCAEvC,6LAAC,oKAAS;wBACR,aAAY;wBACZ,KAAI;;;;;;kCAEN,6LAAC;wBAAe,UAAU;wBAAU,aAAa;wBAAa,kBAAkB;;;;;;kCAChF,6LAAC;wBAAc,UAAU;;;;;;;;;;;;YAG1B,CAAC,0BACA,6LAAC;gBAAI,WAAU;0BAAoK;;;;;;;;;;;;AAM3L;IAvEwB;MAAA"}}]
}